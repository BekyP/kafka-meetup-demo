set 'auto.offset.reset' = 'earliest';

create stream input_stream (timestamp bigint, text varchar, action varchar, browser varchar, device varchar, ip varchar) WITH (KAFKA_TOPIC='input-test-topic', VALUE_FORMAT='json');

CREATE STREAM android_avro_stream WITH (VALUE_FORMAT='AVRO', KAFKA_TOPIC='android-avro-topic', PARTITIONS=1, REPLICAS=1) AS SELECT IP, MASK_LEFT(ip,10) AS IP_MASKED, timestamp, text, action, browser, device FROM input_stream where device = 'android';
CREATE STREAM windows_avro_stream WITH (VALUE_FORMAT='AVRO', KAFKA_TOPIC='windows-avro-topic', PARTITIONS=1, REPLICAS=1) AS SELECT IP, MASK_LEFT(ip,10) AS IP_MASKED, timestamp, text, action, browser, device FROM input_stream  where device = 'windows';
